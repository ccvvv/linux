# 第二章

## 1. 目錄

### 1.1. 主要

| 章節                | 簡介                                                                                               | 檔案      |
| ------------------- | -------------------------------------------------------------------------------------------------- | --------- |
| [序章](./readme.md) | \*                                                                                                 | readme.md |
| [第一章](./1.md)    | \*                                                                                                 | 1.md      |
| 第二章：知錯能改    | 在上一章中，我們學會了如何安裝容器並修改配置，本章將對容器在啟動和配置過程中出現的錯誤資訊進行分析 | 2.md      |
| [第三章](./3.md)    | \*                                                                                                 | 3.md      |

本章寫得相當差勁，建議您在 2022 正式版釋出之前跳過本章。

### 1.2. 本章

中文 | [English](../en/2.md)

- [1. 目錄](#1-目錄)
  - [1.1. 主要](#11-主要)
  - [1.2. 本章](#12-本章)
- [2. 錯誤處理](#2-錯誤處理)
  - [2.1. 種類](#21-種類)
  - [2.2. 分析](#22-分析)
- [3. 常見問題](#3-常見問題)
- [4. 翻頁](#4-翻頁)

## 2. 錯誤處理

### 2.1. 種類

錯誤型別有很多種。  
主要分為可恢復與不可恢復。  
對於不可恢復錯誤，天萌在很多情況下都會直接發生 panic。  
本章主要講解的是前者。

得益於 rust 強大的 Result 型別，天萌 2022 版的錯誤處理也因此變得強大起來了。  
在下一節中，我們將對 2022 版輸出的錯誤資訊進行分析。

### 2.2. 分析

前言：

以下內容僅供參考，由於 2022 版在開發過程中發生了巨大的變化，故實際用法並非如下所示。

正文：

對於使用者輸入而產生的錯誤，而非程式內部邏輯的錯誤，天萌管理器（tmm） 2022 版 對於部分操作可能會輸出表格形式。

假設當前已安裝"鏽"和"紅茶"容器。

注: `r` 是 `tmm` 的 `run` 子命令的簡寫。  
subcommand 的本質就是引數，但是它比普通 argument 更強一點點。

若您未安裝"瓜"容器，則天萌會自動生成提示：

| 錯誤說明       | 回溯                                        |
| -------------- | ------------------------------------------- |
| 您尚未安裝"瓜" | 您執行了"tmm r 瓜",但是天萌未檢測到"瓜"容器 |

解決方案 1(推薦)  
| 步驟 | 描述 | 命令 |  
| ---------------- | -------------------------------- | ---- |  
|1|使用天萌管理器來安裝"瓜"容器 |tmm|  
|2(可選) |線上閱覽安裝文件 |tmm -閱 安 |

解決方案 2：

| 步驟    | 描述                                | 命令      |
| ------- | ----------------------------------- | --------- |
| 1       | 基於配置檔案來安裝“瓜”              |           |
| 2(可選) | 新建（初始化）“瓜”的安裝配置檔案    | tmm 新 瓜 |
| 3       | 修改配置                            | tmm -改 i |
| 4(可選) | 若步驟 3 執行失敗，則使用 vi 編輯器 | vi i.toml |
| 5       | (全新) 安裝                         | tmm 新 瓜 |

解決方案 3

| 步驟    | 描述                                   | 命令       |
| ------- | -------------------------------------- | ---------- |
| 1       | 您想要啟動的可能不是“瓜”，而是其它容器 |            |
| 2(可選) | 啟動"鏽"                               | tmm r 鏽   |
| 3(可選) | 啟動"紅茶"                             | tmm r 紅茶 |
| 4(推薦) | 列出容器選單，並啟動指定容器           | tmm -菜    |
| 5(可選) | 列出容器列表                           | tmm -列    |

解決方案 4  
| 步驟 | 描述 | 命令 |  
| ------- | -------------------------------------- | --------- |  
| 1 | 您想要在"鏽"容器的基礎上，自定義"瓜"容器的配置檔案 | |  
| 2 | 複製 "鏽" 的配置為“瓜” |tmm -復 鏽 瓜 |  
| 3 | 複製“瓜”的配置為本地臨時檔案, 並進行修改 |tmm 瓜 -臨 |  
| 4(可選) | 若步驟 3 執行失敗，則換用 vi 編輯器 |vi c.toml |  
| 5 | 指定“瓜”的配置檔案，並啟動 | tmm 瓜 -配 |  
|6(可選) |若步驟 5 執行失敗，則手動指定 c.toml |tmm 瓜 -配 c |

解決方案 5  
| 步驟 | 描述 | 命令 |  
| ------- | -------------------------------------- | --------- |  
| 1 | 使用診斷功能。注：目前只能診斷出"孤兒"容器，後期可能會為不同容器增加診斷功能 ||  
| 2 |診斷 |tmm 診 |

解決方案 6  
| 步驟 | 描述 | 命令 |  
| ------- | ----------------------------------- | ---------- |  
| 1 | 一起愉快 ♂️ 地交流這個問題 | |  
| 2 | 前往 github 反饋 bug |tmm -報 |  
| 3(可選) |Github discussions | tmm -論 |  
| 4(可選) | 若無法訪問 github,則前往 gitee | tmm -報告 |

| 總結         | 中文引數                         | 英文引數                |
| ------------ | -------------------------------- | ----------------------- |
| 增(Create)   | "新","-新建","-配","-配置","-復" | n, -new, -c, -conf, -cp |
| 刪(Delete)   | "-刪"                            | -rm                     |
| 查(Retrieve) | "-菜","-列","-閱"                | -m, -l, -read           |
| 改(Update)   | "-臨","-改"                      | -t, -e                  |

習題

假設您已經成功安裝了"瓜"容器了。在這種情況下：

    "tmm 瓜 -配"  、"tmm 新 瓜"、"tmm 瓜 -新建" 與"tmm 瓜 -配置"  有什麼區別？

    如何使用特定引數直接編輯"瓜"的配置檔案，而無需生成臨時檔案？

提示：

"tmm -臨 瓜" 可以拆分為兩步。

    tmm 瓜 -配置

    tmm -改

以上表格和習題都是您在輸入錯誤資訊時，天萌管理器自動輸出到終端的內容。  
注：開發者會放棄用中文做引數的做法，因為它相較於英文引數並沒有特別明顯的優勢。

開發者之前將這些資訊記錄在 Onenote 裡，早前想要用引數，後期想用子命令，就造成了衝突。  
看起來可能有點亂。

沒關係，讓我們來梳理一遍。

問題是：您想要啟動“瓜”這個容器？  
但是天萌檢測到您可能沒有安裝。

方案 1 用 TUI 來安裝，對萌新來說更友好。

方案 2 基於“新”的配置檔案來安裝。  
這個檔案不是空檔案，而是一個模板檔案。  
您可以把它理解為`cargo new hello`  
然後你就手動在這個模板裡寫東西，最後基於該檔案進行安裝。

。。。

加上“習題”功能，是開發者在看書的時候得到的靈感。  
開發者希望使用者在遇到問題的時候，能對問題抱有興趣，並嘗試積極地解決它們。  
加入習題是為了鞏固知識點，從而促進知識的內化。

## 3. 常見問題

## 4. 翻頁

| 章節             | 簡介                | 檔案 |
| ---------------- | ------------------- | ---- |
| [上一章](./1.md) | 容器的安裝與配置    | 1.md |
| [下一章](./3.md) | 介紹一下 vscode ... | 3.md |
